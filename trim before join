#quality filter#

qiime quality-filter q-score --i-demux demux.qza --p-min-quality 20 --p-quality-window 3  --p-min-length-fraction 0 --p-max-ambiguous 0 --o-filtered-sequences trimmed.qza --o-filter-stats trim-stats.qza --output-dir trim-unspecified-results

qiime metadata tabulate --m-input-file trim-stats.qza --o-visualization trim-stats.qzv 

qiime demux summarize --i-data trimmed.qza --o-visualization trimmed.qzv

#join the reads#
#allow 1 mismatch

qiime vsearch join-pairs --i-demultiplexed-seqs trimmed.qza --p-minovlen 10 --p-maxdiffs 1 --o-joined-sequences joined-1mismatch.qza --output-dir joined-1mismatch-unspecified-results

qiime demux summarize --i-data joined-1mismatch.qza --o-visualization joined-1mismatch.qzv

qiime tools view joined-1mismatch.qzv



