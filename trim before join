# Trim using fastq-mcf in QIIME 1.80
for i in rawdata/*L001*; do fastq-mcf -k 0 -l 150 -q 20 -w 10 -o ${i/%.fastq/_trim20.fastq} n/a ${i}; done

# Move the R1 and R2 files to a new folder "trim"
mkdir trim
mv *trim20* trim
cd trim

# Get a list of all of the sample names
ls *.fastq | awk -F '_L001' '{print $1'} | uniq > sample_names.txt

# Synchronizing reads in R1 & R2 files
while read p; do perl ../resync --fwd=''"$p"'_L001_R1_001_trim20.fastq' -rev=''"$p"'_L001_R2_001_trim20.fastq'; done < sample_names.txt

# Move the sync read files to a new folder "sync" and export the file names
mkdir sync
mv *sync* sync
cd sync
find $PWD -name *sync* > filenames.txt

# import the paired-end fastq files into QIIME 2 #

# join the reads (allow 1 mismatch) #

qiime vsearch join-pairs --i-demultiplexed-seqs trimmed.qza --p-minovlen 10 --p-maxdiffs 1 --o-joined-sequences joined-1mismatch.qza --output-dir joined-1mismatch-unspecified-results

qiime demux summarize --i-data joined-1mismatch.qza --o-visualization joined-1mismatch.qzv

qiime tools view joined-1mismatch.qzv



